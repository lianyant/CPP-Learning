# 数据的输出与数据的输入

## 1.C语言常用的数据输出/输入函数

### 1).C语言常用输出函数

#### **printf(包含在`stdio.h`头文件中)**：

- `printf` 函数用于输出格式化文本，它是一个可变参函数。格式化文本字符串可以包含格式化指定符，用于确定后续参数如何显示。它可以将各种类型的数据按照指定的格式输出到标准输出设备（通常是屏幕）。对应所在的头文件为：`stdio.h`
- 常见的格式化指定符（格式说明符）包括：
    - `%d` 或 `%i`：输出带符号十进制整数。
    - `%u`：输出无符号十进制整数。
    - `%f`：输出十进制浮点数，默认情况下保留六位小数。
    - `%lf`：输出双精度十进制浮点数，默认情况下保留六位小数（在 C99 和之后的标准中 `%f` 也可以用于 `double` 类型）。
    - `%e` 或 `%E`：输出科学记数法表示的浮点数。
    - `%g` 或 `%G`：根据数值大小自动选择 `%f` 或 `%e`（%E），自动选择 `%f` 或 `%e` 中较短的一种方式输出（`%E` 用于大写形式）。
    - `%x` 或 `%X`：输出无符号十六进制整数（小写/大写）或者说 以十六进制形式输出无符号整数（`%X` 产生大写字母）。
    - `%o`：输出无符号八进制整数。
    - `%c`：输出单个字符。
    - `%s`：输出字符串。
    - `%p`：输出指针地址。
    - `%%`：输出百分号自身。
- 示例：`printf("整数：%d，浮点数：%f\n", 10, 3.14);`

printf函数的格式为：

```c
printf(格式控制字符串,输出表列);
```

​	格式中的“格式控制字符串”是用双引号包含起来的字符串，包含两种可能的信息：
（1）原样输出的普通字符，如“printf（"HelloWorld"）；”，原样输出“HelloWorld”。
（2）字符串中也可以包含格式字符，如已经用过的%d、%f、%c等。

看看下面这行代码：

```c
printf("%d %d\n",a,b);// a,b属于格式中的"输出表列",这里的表列数目不固定,取决于格式控制字符串里有多少个格式字符
```

​	上述printf函数中，圆括号中内容都属于printf函数的参数，因此，printf函数的格式也可以表示为：

```c
printf(参数1,参数2,参数3,……,参数n);
```

​	可以看到，printf函数的参数个数并不固定，其实现的输出功能可以浓缩为一句话：将参数2，参数3，…，参数n按参数1给定的格式输出。在printf函数的格式控制字符串中可以包含格式字符，不少格式字符都曾经用到过，上面("常见的格式化指定符（格式说明符）包括")已经说到了。

##### 拓展1

​	在C和C++中，`printf` 函数及其格式控制字符串的处理具有一些特定的规则和行为，尤其是关于字符串的结束和定义方式。让我们逐一解释这些问题。

**如果格式控制字符串含有 '\0'**

​	在C和C++中，字符串字面量，包括`printf`的格式控制字符串，以空字符`'\0'`结束。这意味着`printf`在处理格式字符串时，将会在遇到第一个`'\0'`字符时停止读取更多的字符。如果格式控制字符串中间含有一个`'\0'`，`printf`将会认为字符串在这里结束，因此它不会处理后续的字符。

​	在C和C++中，字符串字面量以空字符`'\0'`结束。在`printf`函数或其他任何使用C字符串的函数中，如果字符串中间存在一个`\0`，那么这个字符串在`\0`的位置就被视为结束。因此，`printf`会在遇到中间的`\0`时停止处理字符串，不会输出后面的内容。

**示例**

```c
#include <stdio.h>

int main() {
    printf("Hello\0 world!\n");
    return 0;
}

// 或者
#include <stdio.h>

int main() {
    printf("Hello\0 world%d!\n",100);
    return 0;
}
```

​	在上述代码中，输出都将只是“Hello”，因为`'\0'`字符后的“ world!\n”将不会被`printf`函数处理。

**格式控制字符串必定是双引号包含起来的吗？**

​	是的，格式控制字符串通常必须是双引号包围的字符串字面量，这是字符串在C/C++中的标准表示方式。然而，格式字符串也可以是一个字符串变量或者通过字符串表达式动态构成，但最终它们都应该是一个以`'\0'`结尾的字符数组。

**示例**

```c
#include <stdio.h>

int main() {
    char format[] = "Hello, %s!\n";
    printf(format, "world");
    return 0;
}
```

​	在这个例子中，`format`是一个字符数组，用作`printf`的格式控制字符串。虽然它在声明时用双引号包围，但它是作为一个数组变量提供给`printf`。

**结论**

- 格式控制字符串含有`'\0'`将导致`printf`在该位置停止处理字符串，因为`'\0'`在C和C++中用作字符串的结束标记。
- 虽然格式字符串通常由双引号包围的字符串字面量提供，但它们也可以是任何合法的、以`'\0'`结尾的字符数组，包括从变量或表达式构建的字符串。

​	在编写涉及字符串操作的代码时，理解这些行为非常重要，特别是在处理可能包含空字符或动态生成的格式字符串时。

##### 拓展2

(1)用printf函数输出数据时，格式字符要与所输出的数据相匹配，否则输出的结果很可能出错。不可以在printf函数中的第一个参数：格式控制字符串 中单独写出来%d，%f等格式字符，但是不在输出表列中写对应的数据，这样是会出错的。
(2)如果想在printf中输出一个“%”有三种方法:

- ### 使用双百分号 `%%`

```c
printf("输出百分号 %%\n");// 输出百分号 %
```

- ### 使用格式说明符与空参数

```c
printf("%c", '%');// %
```

- ### 使用字符串参数

```c
printf("%s", "%");// %
```

​	推荐使用第一种方法（双百分号 `%%`），因为它是标准的、最直接的，并且在所有的C和C++环境中都是支持的。其他方法虽然技术上可行，但可能会增加代码的复杂度和出错的概率。在编写代码时，清晰和简单总是首选。

(3)%后面跟随的格式化字符一般多为一个字符，其后面紧跟的其他字符并不是格式化字符的一部分。看如下代码：

```c
printf("5%ss\n","%");// 5%s
// 注意第二个s不是格式化字符,会被原样输出
```

(4)错误情况

​	在C或C++中，使用 `printf("%\n");` 是不合法的，这行代码会导致编译时错误或运行时错误。原因是 `%` 符号在 `printf` 函数的格式字符串中用来引导格式说明符，如 `%d`、`%s` 等。单独的 `%` 后面没有跟有效的格式说明符，因此这会导致问题。

**问题解释**

1. **格式字符串解析错误**：`printf` 函数将 `%` 视为格式说明符的开始。如果 `%` 后面没有跟随有效的转换说明符，`printf` 会搜索直到字符串结束也找不到有效的说明符。这通常会导致编译警告或错误，提示格式字符串不完整或不正确。
2. **运行时行为**：如果代码不报编译错误而是运行（依赖于编译器和编译设置），这可能导致运行时错误，如格式字符串解析错误，或者更糟糕的是，未定义行为，这可能包括崩溃或意外的输出。

**正确的做法**

如果你的目的是输出一个 `%` 字符，你应该使用双百分号 `%%` 来正确表示：

```c
printf("%%\n");
```

这样的代码是安全的，将输出一个 `%` 符号，并且不会引起任何解析错误或未定义行为。

**总结**

​	使用 `printf("%\n");` 是不安全的，因为它不符合 `printf` 的格式字符串规则。始终确保格式字符串正确，并避免使用不完整或错误的格式说明符。如果需要输出 `%`，请使用 `%%`。在编写和维护代码时，正确和清晰的格式字符串非常重要，这有助于避免潜在的运行时问题。

#### **putchar函数(包含在 `stdio.h` 头文件中)：**

​	该函数是 C 语言中的一个标准库函数，用于输出单个字符。用于向屏幕输出一个字符，只能输出字符，并且是一个字符，所以该函数的用处不是很大。

​	`putchar` 函数的用法非常简单，它接受一个字符作为参数，并将其写入到标准输出（通常是屏幕）。写入成功时，它会返回写入的字符；如果发生错误，则返回 `EOF`（通常是一个负值）。

下面是一个 `putchar` 函数的简单示例：

```c
#include <stdio.h>

int main() {
    char ch = 'A';
    putchar(ch);  // 输出: A
    putchar('\n');  // 输出新的一行
    return 0;
}
```

在这个示例中，`putchar(ch);` 将字符 `A` 输出到屏幕上，然后 `putchar('\n');` 输出一个换行符，以开始新的一行。

`putchar` 函数通常用于输出单个字符。相比于 `printf`，`putchar` 在输出单个字符时可能更为高效，因为它没有 `printf` 的格式化功能，所以执行起来更简单快捷。然而，由于它的功能比较有限，所以在需要进行复杂格式化的场合，通常还是会选择使用 `printf` 函数。



### 2).C语言常用输入函数

​	数据输入不常用，简单掌握即可，因为书写真正项目代码时一般不会从键盘上输入数据，更何况一旦输入错误还可能会导致程序执行出现异常。

#### **scanf函数(包含在 `stdio.h` 头文件中)：**

`scanf`是用于输入的函数，它从标准输入设备（通常是键盘）读取格式化的输入并将数据存储在变量中。是一个用于从标准输入读取格式化输入的函数。它可以读取包括基本数据类型在内的各种格式的数据。它使用与`printf`类似的格式说明符，但通常需要在变量前加上`&`运算符，因为`scanf`需要变量的地址以便存储输入的值。以下是`scanf`的一些格式说明符：

- `%d`：读取十进制整数。
- `%u`：读取无符号十进制整数。
- `%f`：读取浮点数。
- `%lf`：读取双精度浮点数。
- `%x` 或 `%X`：读取十六进制整数。
- `%o`：读取八进制整数。
- `%c`：读取单个字符。
- `%s`：读取字符串直到遇到空白字符（空格、换行等）。
- `%[...]`：读取匹配括号内字符集的字符序列。

在使用`scanf`时，需要确保提供给格式说明符的变量类型与其匹配，否则可能会导致运行时错误。

简单示例：

```c
#include <stdio.h>

int main() {
    int num;
    printf("Enter a number: ");
    scanf("%d", &num); // 读取一个整数
    printf("You entered: %d\n", num);
    return 0;
}
```

​	在这个示例中，`scanf` 使用 `%d` 格式说明符来读取用户输入的整数，并将其存储在变量 `num` 的地址中。然后程序将输入的数值输出到屏幕上。

#### **getchar函数(包含在 `stdio.h` 头文件中)：**

​	`getchar` 是 C 语言中的一个标准库函数，用于从标准输入读取下一个字符。它不需要任何参数，并从标准输入设备（通常是键盘）读取一个字符。如果成功，`getchar` 会返回读取的字符。如果达到文件末尾或发生读取错误，它会返回 `EOF`。

使用 `getchar` 的简单示例：

```c
#include <stdio.h>

int main() {
    int ch; // 使用 int 类型来处理可能的 EOF
    printf("Enter a character: ");
    ch = getchar(); // 读取一个字符
    printf("You entered: ");
    putchar(ch); // 使用 putchar 函数输出字符
    return 0;
}
```

​	在这个示例中，程序首先提示用户输入一个字符，然后使用 `getchar` 读取用户输入的字符并存储在变量 `ch` 中。之后，它使用 `putchar` 将该字符输出到屏幕上。

### 3).对于getchar和putchar的讨论

1. 当程序执行连续两次的 `getchar()` 调用时，假设用户输入了一个字符比如 `'a'` 并按下回车键，那么：
    - 第一次 `getchar()` 将读取字符 `'a'`。
    - 第二次 `getchar()` 将读取换行符 `\n`，因为在大多数环境中，输入是通过行缓冲处理的，用户按下回车键后输入的整行数据被送入程序，包括换行符。
2. 如果在两次 `getchar()` 调用之间有一个 `putchar(c)` 调用，那么 `putchar(c)` 将输出 `getchar()` 读取到的字符。在常规情况下，这意味着：
    - 如果第一次 `getchar()` 读取了 `'a'`，然后紧接着调用 `putchar(c)`，它将输出 `'a'`。
    - 如果之后再次调用 `getchar()`，它可能读取换行符，紧接着的 `putchar(c)` 调用会输出换行符。
3. 由于 `getchar()` 会连续读取输入缓冲区中的字符，不会跳过任何字符，包括空格、制表符或换行符，因此在两次 `getchar()` 调用之间，用户必须进行一次额外的输入以供第二次调用读取。
4. 最后，`putchar(c)` 将输出其参数 `c` 所指定的字符。如果没有再次调用 `getchar()` 来更新 `c` 的值，那么 `putchar(c)` 会再次输出先前由 `getchar()` 读入的相同字符。

在实际使用时，要注意用户输入与程序预期的匹配。如果程序预期用户输入一个字符后按回车键，那么第一次 `getchar()` 会获取该字符，第二次 `getchar()` 则会获取回车后的换行符 `\n`。这是一个典型的情况，尤其是在命令行界面中进行标准输入时。

​	待验证此结论(vscode下断点看)。

## 2.C++语言常用的数据输出/输入函数

​	C++中，常用的数据输出和输入是通过iostream库中的流对象来处理的，主要包括 `cin` 用于输入和 `cout` 用于输出。它们提供了一种类型安全的方式来读取和写入数据。

### 1).C++语言常用输出函数

#### **cout函数(包含在`iostream` 头文件中)：**

`cout` 是一个`ostream`类的实例，用于向标准输出流发送数据，通常是屏幕。`cout` 通常与插入运算符 `<<` 一起使用，可以连续插入多个值。

```cpp
#include <iostream>

int main() {
    int num = 10;
    double pi = 3.14159;
    std::cout << "The number is " << num << std::endl;
    std::cout << "The value of pi is " << pi << std::endl;
    return 0;
}
```

在这个例子中，`cout` 输出了字符串和变量的值，`std::endl` 是操纵符，用于插入换行符并刷新输出缓冲区。



### 2).C++语言常用输入函数

**cin函数(包含在`iostream` 头文件中)：**

`cin` 是一个`istream`类的实例，用于从标准输入流，通常是键盘，读取数据。`cin` 使用提取运算符 `>>` 与变量关联，从而从输入流中提取值。

```cpp
#include <iostream>

int main() {
    int num;
    std::cout << "Enter a number: ";
    std::cin >> num;
    std::cout << "You entered " << num << std::endl;
    return 0;
}
```

在这个例子中，`cin` 读取了用户从键盘输入的整数，并将其存储在变量 `num` 中。

### 3).总结

​	`cin` 和 `cout` 都是 `iostream` 头文件中定义的对象。`iostream` 头文件是C++标准库的一部分，提供了输入输出流的声明和功能。在C++程序中使用 `cin`（用于输入）和 `cout`（用于输出）时，需要包含 `iostream` 头文件。

下面是一个简单的例子：

```cpp
#include <iostream>

int main() {
    int number;
    std::cout << "Please enter a number: ";
    std::cin >> number;
    std::cout << "You entered: " << number << std::endl;
    return 0;
}
```

​	在这个代码示例中，程序首先打印提示消息，然后读取用户输入的数字并输出该数字。在使用 `cout` 和 `cin` 前，代码包含了 `iostream` 头文件。

​	除了 `cin` 和 `cout`，C++的iostream库还提供了 `cerr` 和 `clog` 用于错误和日志消息的输出。`cerr` 是未缓冲的，直接输出到标准错误设备；`clog` 是缓冲的，输出到同一设备。

​	C++也支持格式化I/O，与 `printf` 和 `scanf` 类似，但通过不同的机制。例如，可以使用 `std::fixed` 和 `std::setprecision` 来控制浮点数输出的格式。

```cpp
#include <iostream>
#include <iomanip> // 包含格式化操作所需的头文件

int main() {
    double pi = 3.14159;
    std::cout << std::fixed << std::setprecision(2) << pi << std::endl; // 输出: 3.14
    return 0;
}
```

这些特性使C++的I/O机制更加强大和灵活，同时也更加安全，因为它们在编译时就会检查类型。